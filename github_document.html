<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>M&amp;0 Assignment Task 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="M&amp;O assignment task 1_files/libs/clipboard/clipboard.min.js"></script>
<script src="M&amp;O assignment task 1_files/libs/quarto-html/quarto.js"></script>
<script src="M&amp;O assignment task 1_files/libs/quarto-html/popper.min.js"></script>
<script src="M&amp;O assignment task 1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="M&amp;O assignment task 1_files/libs/quarto-html/anchor.min.js"></script>
<link href="M&amp;O assignment task 1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="M&amp;O assignment task 1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="M&amp;O assignment task 1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="M&amp;O assignment task 1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="M&amp;O assignment task 1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">M&amp;0 Assignment Task 1</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="quarto" class="level2">
<h2 class="anchored" data-anchor-id="quarto">Quarto</h2>
<p>Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <a href="https://quarto.org" class="uri">https://quarto.org</a>.</p>
</section>
<section id="running-code" class="level2">
<h2 class="anchored" data-anchor-id="running-code">Running Code</h2>
<p>When you click the <strong>Render</strong> button a document will be generated that includes both content and the output of embedded code. You can embed code like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>You can add options to executable code like this</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>The <code>echo: false</code> option disables the printing of code (only output is displayed).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kernlab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'kernlab' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'caret' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggplot2'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:kernlab':

    alpha</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get the directory of our file</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/Users/hamsa/M&amp;O"</code></pre>
</div>
</div>
</section>
<section id="preprocess" class="level1">
<h1>Preprocess</h1>
<p>We first load the data by putting the file on the same directory as this file</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the dataset</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>student_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"student-mat.csv"</span>, <span class="at">sep =</span> <span class="st">";"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Given that many columns are categorical, e,g, sex, famsize, Pstatus, etcâ€¦ we change them to cateogrical numbers. And we then define X, the variables we will use to predict our target variable, y which is G3 (Our target variable).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(student_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>student_data <span class="ot">&lt;-</span>  <span class="fu">na.omit</span>(student_data)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Encode categorical variables using one-hot encoding</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>student_data_encoded <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> . <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> student_data)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define target variable (G3 for regression)</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> student_data_encoded[, <span class="sc">!</span><span class="fu">colnames</span>(student_data_encoded) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"G3"</span>)]</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> student_data_encoded[, <span class="st">"G3"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize numerical features</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">scale</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load caret package</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data into training and testing sets</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>trainIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(y, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>trainData <span class="ot">&lt;-</span> X[trainIndex, ]</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>testData <span class="ot">&lt;-</span> X[<span class="sc">-</span>trainIndex, ]</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>trainTarget <span class="ot">&lt;-</span> y[trainIndex]</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>testTarget <span class="ot">&lt;-</span> y[<span class="sc">-</span>trainIndex]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now calculate the correlation between variables and then define the variable features that we will use in our regression model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlation between features and target variable</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(student_data_encoded)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>correlation_with_target <span class="ot">&lt;-</span> correlation_matrix[, <span class="st">"G3"</span>]</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Select features with high correlation (e.g., absolute correlation &gt; 0.1)</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>selected_features <span class="ot">&lt;-</span> <span class="fu">names</span>(correlation_with_target[<span class="fu">abs</span>(correlation_with_target) <span class="sc">&gt;</span> <span class="fl">0.1</span>])</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>selected_features_g3 <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(selected_features, <span class="st">"G3"</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>selected_features</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "sexM"        "age"         "addressU"    "Medu"        "Fedu"       
 [6] "Mjobhealth"  "traveltime"  "failures"    "paidyes"     "higheryes"  
[11] "romanticyes" "goout"       "G1"          "G2"          "G3"         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the dataset to include only selected features</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>X_selected <span class="ot">&lt;-</span> X[, selected_features_g3]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So now that we have the selected features, letâ€™s look how each one behaves with G3.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> student_data_encoded</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(student_data_encoded)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the list of variables excluding "G3"</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>other_vars <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">colnames</span>(new_data), <span class="st">"G3"</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each variable and create individual scatterplots with correlation</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> other_vars) {</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate correlation coefficient</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  cor_value <span class="ot">&lt;-</span> <span class="fu">cor</span>(new_data[[var]], new_data<span class="sc">$</span>G3, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create plot</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(new_data, <span class="fu">aes_string</span>(<span class="at">x =</span> var, <span class="at">y =</span> <span class="st">"G3"</span>)) <span class="sc">+</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span>  <span class="co"># Scatterplot</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span>  <span class="co"># Regression line</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"G3 vs"</span>, var, <span class="st">"- Correlation:"</span>, <span class="fu">round</span>(cor_value, <span class="dv">2</span>))) <span class="sc">+</span>  <span class="co"># Title with correlation</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p)  <span class="co"># Print each plot separately</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
â„¹ Please use tidy evaluation idioms with `aes()`.
â„¹ See also `vignette("ggplot2-in-packages")` for more information.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-10.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-11.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-12.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-13.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-14.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-15.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-16.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-17.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-18.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-19.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-20.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-21.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-22.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-23.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-24.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-25.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-26.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-27.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-28.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-29.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-30.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-31.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-32.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-33.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-34.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-35.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-36.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-37.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-38.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-39.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-40.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-41.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-10-42.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Since many of these are categorical, there isnâ€™t much of a correlation. However, we can see that the two variables with the strongest correlation with G3 are G1 and G2.Next we proceed with training the models:</p>
</section>
<section id="training-models" class="level1">
<h1>Training models</h1>
<section id="gpr" class="level2">
<h2 class="anchored" data-anchor-id="gpr">GPR</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kernlab)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Gaussian Process Regression (GPR) model</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co">#gprModel &lt;- gausspr(X_selected[trainIndex, ], trainTarget, kernel = "rbfdot")</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>gprModel_1 <span class="ot">&lt;-</span> <span class="fu">gausspr</span>(trainTarget <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">as.data.frame</span>(X_selected[trainIndex, ]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Using automatic sigma estimation (sigest) for RBF or laplace kernel </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gprModel_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Length   Class    Mode 
      1 gausspr      S4 </code></pre>
</div>
</div>
<p>Now that the model is trained, we test it against the testing data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on test data</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co">#gprPredictions &lt;- predict(gprModel, X_selected[-trainIndex, ])</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>gprPredictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel_1, X_selected[<span class="sc">-</span>trainIndex, ])</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate evaluation metrics</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((testTarget <span class="sc">-</span> gprPredictions)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>rsquared <span class="ot">&lt;-</span> <span class="fu">cor</span>(testTarget, gprPredictions)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print evaluation metrics</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean Squared Error (MSE):"</span>, mse, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean Squared Error (MSE): 5.121873 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared (RÂ²):"</span>, rsquared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared (RÂ²): 0.7431295 </code></pre>
</div>
</div>
</section>
<section id="linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression">Linear regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Linear Regression model</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>lmModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(trainTarget <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">as.data.frame</span>(X_selected[trainIndex, ]))</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = trainTarget ~ ., data = as.data.frame(X_selected[trainIndex, 
    ]))

Residuals:
    Min      1Q  Median      3Q     Max 
-9.3366 -0.3459  0.2963  0.9748  3.5695 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 10.40552    0.11199  92.918   &lt;2e-16 ***
sexM         0.09920    0.11927   0.832   0.4062    
age         -0.21377    0.11974  -1.785   0.0752 .  
addressU     0.01521    0.12274   0.124   0.9014    
Medu         0.17772    0.15600   1.139   0.2555    
Fedu        -0.16536    0.14803  -1.117   0.2649    
Mjobhealth   0.03864    0.11793   0.328   0.7434    
traveltime   0.14492    0.12201   1.188   0.2359    
failures    -0.02157    0.13572  -0.159   0.8739    
paidyes      0.06324    0.11755   0.538   0.5910    
higheryes   -0.01419    0.12537  -0.113   0.9100    
romanticyes -0.12534    0.11663  -1.075   0.2834    
goout        0.09555    0.11603   0.823   0.4109    
G1           0.57516    0.22243   2.586   0.0102 *  
G2           3.57091    0.22215  16.075   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.995 on 303 degrees of freedom
Multiple R-squared:  0.8225,    Adjusted R-squared:  0.8143 
F-statistic: 100.3 on 14 and 303 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>We can see that only G1 and G2 are much of significance when it comes to predicting our target variable. Next is evaluation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on test data</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>lmPredictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(lmModel, <span class="at">newdata =</span> <span class="fu">as.data.frame</span>(X_selected[<span class="sc">-</span>trainIndex, ]))</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate evaluation metrics</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>mse_lm <span class="ot">&lt;-</span> <span class="fu">mean</span>((testTarget <span class="sc">-</span> lmPredictions)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>rmse_lm <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse_lm)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>rsquared_lm <span class="ot">&lt;-</span> <span class="fu">cor</span>(testTarget, lmPredictions)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print evaluation metrics</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Linear Regression Metrics:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression Metrics:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean Squared Error (MSE):"</span>, mse_lm, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean Squared Error (MSE): 3.051661 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Root Mean Squared Error (RMSE):"</span>, rmse_lm, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Root Mean Squared Error (RMSE): 1.7469 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared (RÂ²):"</span>, rsquared_lm, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared (RÂ²): 0.842344 </code></pre>
</div>
</div>
</section>
<section id="lasso-regression" class="level2">
<h2 class="anchored" data-anchor-id="lasso-regression">Lasso regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loaded glmnet 4.1-8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for glmnet</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>X_train <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X_selected[trainIndex, ])</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>X_test <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X_selected[<span class="sc">-</span>trainIndex, ])</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>y_train <span class="ot">&lt;-</span> trainTarget</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Lasso Regression model</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>lassoModel <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(X_train, y_train, <span class="at">alpha =</span> <span class="dv">1</span>)  <span class="co"># alpha = 1 for Lasso</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print best lambda value</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best Lambda for Lasso:"</span>, lassoModel<span class="sc">$</span>lambda.min, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Lambda for Lasso: 0.1605949 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on test data</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>lassoPredictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(lassoModel, <span class="at">s =</span> lassoModel<span class="sc">$</span>lambda.min, <span class="at">newx =</span> X_test)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate evaluation metrics</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>mse_lasso <span class="ot">&lt;-</span> <span class="fu">mean</span>((testTarget <span class="sc">-</span> lassoPredictions)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>rmse_lasso <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse_lasso)</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>rsquared_lasso <span class="ot">&lt;-</span> <span class="fu">cor</span>(testTarget, lassoPredictions)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print evaluation metrics</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Lasso Regression Metrics:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Lasso Regression Metrics:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean Squared Error (MSE):"</span>, mse_lasso, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean Squared Error (MSE): 2.952104 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Root Mean Squared Error (RMSE):"</span>, rmse_lasso, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Root Mean Squared Error (RMSE): 1.718169 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared (RÂ²):"</span>, rsquared_lasso, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared (RÂ²): 0.8506787 </code></pre>
</div>
</div>
</section>
<section id="ridge-regression" class="level2">
<h2 class="anchored" data-anchor-id="ridge-regression">Ridge regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Ridge Regression model</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>ridgeModel <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(X_train, y_train, <span class="at">alpha =</span> <span class="dv">0</span>)  <span class="co"># alpha = 0 for Ridge</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print best lambda value</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best Lambda for Ridge:"</span>, ridgeModel<span class="sc">$</span>lambda.min, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Lambda for Ridge: 0.4167478 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on test data</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>ridgePredictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(ridgeModel, <span class="at">s =</span> ridgeModel<span class="sc">$</span>lambda.min, <span class="at">newx =</span> X_test)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate evaluation metrics</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>mse_ridge <span class="ot">&lt;-</span> <span class="fu">mean</span>((testTarget <span class="sc">-</span> ridgePredictions)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>rmse_ridge <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse_ridge)</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>rsquared_ridge <span class="ot">&lt;-</span> <span class="fu">cor</span>(testTarget, ridgePredictions)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print evaluation metrics</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Ridge Regression Metrics:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ridge Regression Metrics:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean Squared Error (MSE):"</span>, mse_ridge, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean Squared Error (MSE): 3.198452 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Root Mean Squared Error (RMSE):"</span>, rmse_ridge, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Root Mean Squared Error (RMSE): 1.788422 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared (RÂ²):"</span>, rsquared_ridge, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared (RÂ²): 0.8382714 </code></pre>
</div>
</div>
</section>
<section id="gpr-improvements" class="level2">
<h2 class="anchored" data-anchor-id="gpr-improvements">GPR improvements</h2>
<p>Now we try ways to improve the guassian process model. First is changing the kernel</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try Matern Kernel</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>gprModel_tanhdot <span class="ot">&lt;-</span> <span class="fu">gausspr</span>(X_selected[trainIndex, ], trainTarget, <span class="at">kernel =</span> <span class="st">"tanhdot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Setting default kernel parameters  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try Polynomial Kernel</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>gprModel_poly <span class="ot">&lt;-</span> <span class="fu">gausspr</span>(X_selected[trainIndex, ], trainTarget, <span class="at">kernel =</span> <span class="st">"polydot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Setting default kernel parameters  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the models</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>gprPredictions_tanhdot <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel_tanhdot, X_selected[<span class="sc">-</span>trainIndex, ])</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>gprPredictions_poly <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel_poly, X_selected[<span class="sc">-</span>trainIndex, ])</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>mse_tanhdot <span class="ot">&lt;-</span> <span class="fu">mean</span>((testTarget <span class="sc">-</span> gprPredictions_tanhdot)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>mse_poly <span class="ot">&lt;-</span> <span class="fu">mean</span>((testTarget <span class="sc">-</span> gprPredictions_poly)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>rsquared_gprpoly <span class="ot">&lt;-</span> <span class="fu">cor</span>(testTarget, gprPredictions_poly)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"MSE (tanhdot Kernel):"</span>, mse_tanhdot, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MSE (tanhdot Kernel): 1859.83 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"MSE (Polynomial Kernel):"</span>, mse_poly, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MSE (Polynomial Kernel): 3.053982 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared (RÂ²):"</span>, rsquared_gprpoly, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared (RÂ²): 0.8423407 </code></pre>
</div>
</div>
<p>Now it became 2nd best model (polynomial). So we will be using that model from now on.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>gprModel <span class="ot">&lt;-</span> <span class="fu">gausspr</span>(X_selected[trainIndex, ], trainTarget, <span class="at">kernel =</span> <span class="st">"polydot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Setting default kernel parameters  </code></pre>
</div>
</div>
<p>One area GPR outperforms other linear models is small subsets because linear models tend to overfit. So letâ€™s try to see their performances on a small subset of the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a small subset of the data</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>small_index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X_selected), <span class="dv">50</span>)  <span class="co"># Use 50 samples</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>X_small <span class="ot">&lt;-</span> X_selected[small_index, ]</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>y_small <span class="ot">&lt;-</span> y[small_index]</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a><span class="co">#gpr</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>gpr_small_model <span class="ot">&lt;-</span> <span class="fu">gausspr</span>(X_small, y_small, <span class="at">kernel =</span> <span class="st">"polydot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Setting default kernel parameters  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>gprPredictions_small_gpr <span class="ot">&lt;-</span> <span class="fu">predict</span>(gpr_small_model, X_selected[<span class="sc">-</span>trainIndex, ])</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>mse_gpr_small <span class="ot">&lt;-</span> <span class="fu">mean</span>((testTarget <span class="sc">-</span> gprPredictions_small_gpr)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>rsquared_gprsmall <span class="ot">&lt;-</span> <span class="fu">cor</span>(testTarget, gprPredictions_small_gpr)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="co">#ridge</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>X_train <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X_small)</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>X_test <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X_selected[<span class="sc">-</span>trainIndex, ])</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>y_train <span class="ot">&lt;-</span> trainTarget</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>ridgeModel_small <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(X_train, y_small, <span class="at">alpha =</span> <span class="dv">0</span>)</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>ridgePredictions_small <span class="ot">&lt;-</span> <span class="fu">predict</span>(ridgeModel_small, <span class="at">s =</span> ridgeModel_small<span class="sc">$</span>lambda.min, <span class="at">newx =</span> X_test)</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>mse_ridge_small <span class="ot">&lt;-</span> <span class="fu">mean</span>((testTarget <span class="sc">-</span> ridgePredictions_small)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>rsquared_ridge_small <span class="ot">&lt;-</span> <span class="fu">cor</span>(testTarget, ridgePredictions_small)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Lasso</span></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>lassoModel_small <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(X_train, y_small, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>lassoPredictions_small <span class="ot">&lt;-</span> <span class="fu">predict</span>(lassoModel_small, <span class="at">s =</span> lassoModel_small<span class="sc">$</span>lambda.min, <span class="at">newx =</span> X_test)</span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>mse_lasso_small <span class="ot">&lt;-</span> <span class="fu">mean</span>((testTarget <span class="sc">-</span> lassoPredictions_small)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>rsquared_lasso_small <span class="ot">&lt;-</span> <span class="fu">cor</span>(testTarget, lassoPredictions_small)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Linear</span></span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>lmModel_small <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_small <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">as.data.frame</span>(X_small))</span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>lmPredictions_small <span class="ot">&lt;-</span> <span class="fu">predict</span>(lmModel_small, <span class="at">newdata =</span> <span class="fu">as.data.frame</span>(X_selected[<span class="sc">-</span>trainIndex, ]))</span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>mse_lm_small <span class="ot">&lt;-</span> <span class="fu">mean</span>((testTarget <span class="sc">-</span> lmPredictions_small)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>rsquared_lm_small <span class="ot">&lt;-</span> <span class="fu">cor</span>(testTarget, lmPredictions_small)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a>mse_gpr_small</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.711567</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>mse_ridge_small</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.696957</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>mse_lasso_small</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.101506</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>mse_lm_small</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.735554</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>rsquared_gprsmall</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 0.8068197</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>rsquared_ridge_small</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            s1
[1,] 0.8086956</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>rsquared_lasso_small</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            s1
[1,] 0.8479715</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>rsquared_lm_small</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8058454</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train and compare models on the small dataset</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (Include Linear Regression, Lasso, Ridge, and GPR)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lasso regression seem to be doing the best. This didnâ€™t back up our inital hypothesis. Next letâ€™s see the how the GPR model captures the non-linear relationship that other linear models canâ€™t.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize non-linear relationships with GPR with each feature</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"sexM"</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a grid of values for the selected feature</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict using GPR</span></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>X_selected_test <span class="ot">&lt;-</span> X_selected[<span class="sc">-</span>trainIndex,]</span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the relationship</span></span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grid_values, grid_predictions, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> feature, <span class="at">ylab =</span> <span class="st">"Predicted G3"</span>, <span class="at">main =</span> <span class="st">"Non-Linear Relationship Captured by GPR"</span>)</span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Add points to the plot</span></span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X_selected_test[, feature_index], testTarget, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Age</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"age"</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>X_selected_test <span class="ot">&lt;-</span> X_selected[<span class="sc">-</span>trainIndex,]</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grid_values, grid_predictions, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> feature, <span class="at">ylab =</span> <span class="st">"Predicted G3"</span>, <span class="at">main =</span> <span class="st">"Non-Linear Relationship Captured by GPR"</span>)</span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X_selected_test[, feature_index], testTarget, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co">#addressU</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"addressU"</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>X_selected_test <span class="ot">&lt;-</span> X_selected[<span class="sc">-</span>trainIndex,]</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grid_values, grid_predictions, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> feature, <span class="at">ylab =</span> <span class="st">"Predicted G3"</span>, <span class="at">main =</span> <span class="st">"Non-Linear Relationship Captured by GPR"</span>)</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X_selected_test[, feature_index], testTarget, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-21-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Medu</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"Medu"</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>X_selected_test <span class="ot">&lt;-</span> X_selected[<span class="sc">-</span>trainIndex,]</span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grid_values, grid_predictions, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> feature, <span class="at">ylab =</span> <span class="st">"Predicted G3"</span>, <span class="at">main =</span> <span class="st">"Non-Linear Relationship Captured by GPR"</span>)</span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X_selected_test[, feature_index], testTarget, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-21-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Fedu</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"Fedu"</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>X_selected_test <span class="ot">&lt;-</span> X_selected[<span class="sc">-</span>trainIndex,]</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grid_values, grid_predictions, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> feature, <span class="at">ylab =</span> <span class="st">"Predicted G3"</span>, <span class="at">main =</span> <span class="st">"Non-Linear Relationship Captured by GPR"</span>)</span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X_selected_test[, feature_index], testTarget, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-21-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mjobhealth</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"Mjobhealth"</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>X_selected_test <span class="ot">&lt;-</span> X_selected[<span class="sc">-</span>trainIndex,]</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grid_values, grid_predictions, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> feature, <span class="at">ylab =</span> <span class="st">"Predicted G3"</span>, <span class="at">main =</span> <span class="st">"Non-Linear Relationship Captured by GPR"</span>)</span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X_selected_test[, feature_index], testTarget, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-21-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co">#traveltime</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"traveltime"</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>X_selected_test <span class="ot">&lt;-</span> X_selected[<span class="sc">-</span>trainIndex,]</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grid_values, grid_predictions, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> feature, <span class="at">ylab =</span> <span class="st">"Predicted G3"</span>, <span class="at">main =</span> <span class="st">"Non-Linear Relationship Captured by GPR"</span>)</span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X_selected_test[, feature_index], testTarget, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-21-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co">#failures</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"failures"</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>X_selected_test <span class="ot">&lt;-</span> X_selected[<span class="sc">-</span>trainIndex,]</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grid_values, grid_predictions, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> feature, <span class="at">ylab =</span> <span class="st">"Predicted G3"</span>, <span class="at">main =</span> <span class="st">"Non-Linear Relationship Captured by GPR"</span>)</span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X_selected_test[, feature_index], testTarget, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-21-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co">#paidyes</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"paidyes"</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>X_selected_test <span class="ot">&lt;-</span> X_selected[<span class="sc">-</span>trainIndex,]</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grid_values, grid_predictions, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> feature, <span class="at">ylab =</span> <span class="st">"Predicted G3"</span>, <span class="at">main =</span> <span class="st">"Non-Linear Relationship Captured by GPR"</span>)</span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X_selected_test[, feature_index], testTarget, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-21-9.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co">#higheryes</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"higheryes"</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>X_selected_test <span class="ot">&lt;-</span> X_selected[<span class="sc">-</span>trainIndex,]</span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grid_values, grid_predictions, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> feature, <span class="at">ylab =</span> <span class="st">"Predicted G3"</span>, <span class="at">main =</span> <span class="st">"Non-Linear Relationship Captured by GPR"</span>)</span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X_selected_test[, feature_index], testTarget, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-21-10.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co">#romanticyes</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"romanticyes"</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>X_selected_test <span class="ot">&lt;-</span> X_selected[<span class="sc">-</span>trainIndex,]</span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grid_values, grid_predictions, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> feature, <span class="at">ylab =</span> <span class="st">"Predicted G3"</span>, <span class="at">main =</span> <span class="st">"Non-Linear Relationship Captured by GPR"</span>)</span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X_selected_test[, feature_index], testTarget, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-21-11.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co">#goout</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"goout"</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>X_selected_test <span class="ot">&lt;-</span> X_selected[<span class="sc">-</span>trainIndex,]</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grid_values, grid_predictions, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> feature, <span class="at">ylab =</span> <span class="st">"Predicted G3"</span>, <span class="at">main =</span> <span class="st">"Non-Linear Relationship Captured by GPR"</span>)</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X_selected_test[, feature_index], testTarget, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-21-12.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co">#G1</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"G1"</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>X_selected_test <span class="ot">&lt;-</span> X_selected[<span class="sc">-</span>trainIndex,]</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grid_values, grid_predictions, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> feature, <span class="at">ylab =</span> <span class="st">"Predicted G3"</span>, <span class="at">main =</span> <span class="st">"Non-Linear Relationship Captured by GPR"</span>)</span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X_selected_test[, feature_index], testTarget, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-21-13.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co">#G2</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"G2"</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>X_selected_test <span class="ot">&lt;-</span> X_selected[<span class="sc">-</span>trainIndex,]</span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grid_values, grid_predictions, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> feature, <span class="at">ylab =</span> <span class="st">"Predicted G3"</span>, <span class="at">main =</span> <span class="st">"Non-Linear Relationship Captured by GPR"</span>)</span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X_selected_test[, feature_index], testTarget, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-21-14.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Earlier we seen that the linear line of best fit wasnâ€™t quite correct. Hence GPR captures the non linear relationship much better than the rest of the models. Now we can find the optimal value for each feature that optimises G3.</p>
</section>
</section>
<section id="optimal-values" class="level1">
<h1>Optimal values</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co">#sexM</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"sexM"</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>optimal_sexM_gpr <span class="ot">&lt;-</span> grid_values[<span class="fu">which.max</span>(grid_predictions)]</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal sexM:"</span>, optimal_sexM_gpr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal sexM: 0.0026599 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co">#age</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"age"</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>optimal_age_gpr <span class="ot">&lt;-</span> grid_values[<span class="fu">which.max</span>(grid_predictions)]</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal Age:"</span>, optimal_age_gpr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal Age: 1.275059 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co">#addressU</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"addressU"</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>optimal_addressU_gpr <span class="ot">&lt;-</span> grid_values[<span class="fu">which.max</span>(grid_predictions)]</span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal addressU:"</span>, optimal_addressU_gpr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal addressU: -0.7259641 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Medu</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"Medu"</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>optimal_Medu_gpr <span class="ot">&lt;-</span> grid_values[<span class="fu">which.max</span>(grid_predictions)]</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal Medu:"</span>, optimal_Medu_gpr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal Medu: -0.7767881 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Fedu</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"Fedu"</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>optimal_Fedu_gpr <span class="ot">&lt;-</span> grid_values[<span class="fu">which.max</span>(grid_predictions)]</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal Fedu:"</span>, optimal_Fedu_gpr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal Fedu: -0.572072 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mjobhealth</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"Mjobhealth"</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>optimal_Mjobhealth_gpr <span class="ot">&lt;-</span> grid_values[<span class="fu">which.max</span>(grid_predictions)]</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal Mjobhealth:"</span>, optimal_Mjobhealth_gpr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal Mjobhealth: 1.384001 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co">#traveltime</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"traveltime"</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>optimal_traveltime_gpr <span class="ot">&lt;-</span> grid_values[<span class="fu">which.max</span>(grid_predictions)]</span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal travel time:"</span>, optimal_traveltime_gpr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal travel time: 1.399476 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co">#failures</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"failures"</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>optimal_failures_gpr <span class="ot">&lt;-</span> grid_values[<span class="fu">which.max</span>(grid_predictions)]</span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal failures:"</span>, optimal_failures_gpr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal failures: 1.465829 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co">#paidyes</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"paidyes"</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>optimal_paidyes_gpr <span class="ot">&lt;-</span> grid_values[<span class="fu">which.max</span>(grid_predictions)]</span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal paidyes:"</span>, optimal_paidyes_gpr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal paidyes: 0.03311317 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co">#higheryes</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"higheryes"</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>optimal_higheryes_gpr <span class="ot">&lt;-</span> grid_values[<span class="fu">which.max</span>(grid_predictions)]</span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal higheryes:"</span>, optimal_higheryes_gpr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal higheryes: -2.16203 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co">#romanticyes</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"romanticyes"</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a>optimal_romanticyes_gpr <span class="ot">&lt;-</span> grid_values[<span class="fu">which.max</span>(grid_predictions)]</span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal romanticyes:"</span>, optimal_romanticyes_gpr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal romanticyes: 0.297629 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co">#goout</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"goout"</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>optimal_goout_gpr <span class="ot">&lt;-</span> grid_values[<span class="fu">which.max</span>(grid_predictions)]</span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal goout:"</span>, optimal_goout_gpr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal goout: -0.1885161 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co">#G1</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"G1"</span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>optimal_G1_gpr <span class="ot">&lt;-</span> grid_values[<span class="fu">which.max</span>(grid_predictions)]</span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal G1:"</span>, optimal_G1_gpr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal G1: -0.09427021 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co">#G2</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"G2"</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>grid_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X_selected[, feature_index]), <span class="fu">max</span>(X_selected[, feature_index]), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> X_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]  <span class="co"># Use the first 100 rows for prediction</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>grid_data[, feature_index] <span class="ot">&lt;-</span> grid_values</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel, grid_data)</span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>optimal_G2_gpr <span class="ot">&lt;-</span> grid_values[<span class="fu">which.max</span>(grid_predictions)]</span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal G2:"</span>, optimal_G2_gpr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal G2: 1.794687 </code></pre>
</div>
</div>
<p>While other regression models can find the optimal values for the features, they assume a linear relationship which is not the case hence why GPR outshine them. In fact letâ€™s compare it with other models for optimal values</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear mode</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>lmModel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = trainTarget ~ ., data = as.data.frame(X_selected[trainIndex, 
    ]))

Coefficients:
(Intercept)         sexM          age     addressU         Medu         Fedu  
   10.40552      0.09920     -0.21377      0.01521      0.17772     -0.16536  
 Mjobhealth   traveltime     failures      paidyes    higheryes  romanticyes  
    0.03864      0.14492     -0.02157      0.06324     -0.01419     -0.12534  
      goout           G1           G2  
    0.09555      0.57516      3.57091  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>coefficients <span class="ot">&lt;-</span> <span class="fu">coef</span>(lmModel)</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Linear Regression Coefficients:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression Coefficients:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(coefficients)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        sexM         age    addressU        Medu        Fedu 
10.40551906  0.09920213 -0.21377303  0.01521249  0.17771700 -0.16535540 
 Mjobhealth  traveltime    failures     paidyes   higheryes romanticyes 
 0.03864119  0.14491541 -0.02156613  0.06324311 -0.01418636 -0.12533637 
      goout          G1          G2 
 0.09554656  0.57515967  3.57090564 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the optimal study time</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume the relationship is linear: y = b0 + b1 * studytime</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>optimal_sexM_lm <span class="ot">&lt;-</span> (<span class="fu">max</span>(trainTarget) <span class="sc">-</span> coefficients[<span class="st">"(Intercept)"</span>]) <span class="sc">/</span> coefficients[<span class="st">"sexM"</span>]</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal sexM (Linear Regression):"</span>, optimal_sexM_lm, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal sexM (Linear Regression): 96.71648 </code></pre>
</div>
</div>
<p>All we did is that we rearranged the linear regression equation and obtained this value. The equation we used is</p>
<p><span class="math display">\[
optimal sexM= {max(trainTarget) - b_0 \over b_1}
\]</span> The reason we set the y value as max(trainTarget) is because we want to find the value that maximises it. Now we compare the two.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set the feature</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"sexM"</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>feature_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(X_selected) <span class="sc">==</span> feature)</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare optimal values</span></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal sexM (Linear Regression):"</span>, optimal_sexM_lm, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal sexM (Linear Regression): 96.71648 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal sexM (GPR):"</span>, optimal_sexM_gpr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal sexM (GPR): 0.0026599 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check which value is closer to the observed data</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>observed_max_sexM <span class="ot">&lt;-</span> <span class="fu">max</span>(X_selected[, feature_index])</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Maximum Observed sexM:"</span>, observed_max_sexM, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Maximum Observed sexM: 1.05332 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate differences</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>diff_lm <span class="ot">&lt;-</span> <span class="fu">abs</span>(optimal_sexM_lm <span class="sc">-</span> observed_max_sexM)</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>diff_gpr <span class="ot">&lt;-</span> <span class="fu">abs</span>(optimal_sexM_gpr <span class="sc">-</span> observed_max_sexM)</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Difference (Linear Regression):"</span>, diff_lm, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Difference (Linear Regression): 95.66316 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Difference (GPR):"</span>, diff_gpr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Difference (GPR): 1.05066 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine which model is better</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (diff_gpr <span class="sc">&lt;</span> diff_lm) {</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"GPR provides a more realistic optimal value.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Linear Regression provides a more realistic optimal value.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GPR provides a more realistic optimal value.</code></pre>
</div>
</div>
<p>As you can see gpr does indeed provide much better optimal value. so now letâ€™s check for lasso and ridge regression. We will define a function for the linear relationship.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ridge and Lasso</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>lassoModel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  cv.glmnet(x = X_train, y = y_train, alpha = 1) 

Measure: Mean-Squared Error 

    Lambda Index Measure     SE Nonzero
min 0.1606    36   4.041 0.7692       4
1se 0.8570    18   4.792 0.8125       2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>ridgeModel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  cv.glmnet(x = X_train, y = y_train, alpha = 0) 

Measure: Mean-Squared Error 

    Lambda Index Measure     SE Nonzero
min 0.4167   100   4.264 0.7639      14
1se 1.6824    85   4.940 0.8219      14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>lasso_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(lassoModel, <span class="at">s =</span> <span class="st">"lambda.min"</span>)</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>ridge_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(ridgeModel, <span class="at">s =</span> <span class="st">"lambda.min"</span>)</span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to find optimal feature value</span></span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a>find_optimal_value <span class="ot">&lt;-</span> <span class="cf">function</span>(coefficients, feature_name, max_target) {</span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>  intercept <span class="ot">&lt;-</span> coefficients[<span class="st">"(Intercept)"</span>, ]</span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>  feature_coef <span class="ot">&lt;-</span> coefficients[feature_name, ]</span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a>  optimal_value <span class="ot">&lt;-</span> (max_target <span class="sc">-</span> intercept) <span class="sc">/</span> feature_coef</span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(optimal_value)</span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb209-12"><a href="#cb209-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-13"><a href="#cb209-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-14"><a href="#cb209-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Find optimal study time using Lasso and Ridge</span></span>
<span id="cb209-15"><a href="#cb209-15" aria-hidden="true" tabindex="-1"></a>max_target <span class="ot">&lt;-</span> <span class="fu">max</span>(trainTarget)</span>
<span id="cb209-16"><a href="#cb209-16" aria-hidden="true" tabindex="-1"></a>feature <span class="ot">&lt;-</span> <span class="st">"sexM"</span></span>
<span id="cb209-17"><a href="#cb209-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-18"><a href="#cb209-18" aria-hidden="true" tabindex="-1"></a>optimal_sexM_lasso <span class="ot">&lt;-</span> <span class="fu">find_optimal_value</span>(lasso_coef, feature, max_target)</span>
<span id="cb209-19"><a href="#cb209-19" aria-hidden="true" tabindex="-1"></a>optimal_sexM_ridge <span class="ot">&lt;-</span> <span class="fu">find_optimal_value</span>(ridge_coef, feature, max_target)</span>
<span id="cb209-20"><a href="#cb209-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-21"><a href="#cb209-21" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal sexM (Lasso):"</span>, optimal_sexM_lasso, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal sexM (Lasso): Inf </code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal sexM (Ridge):"</span>, optimal_sexM_ridge, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal sexM (Ridge): 81.29993 </code></pre>
</div>
</div>
<p>Now comparing it to the gpr model, we get this</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate differences</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>diff_lasso <span class="ot">&lt;-</span> <span class="fu">abs</span>(optimal_sexM_lasso <span class="sc">-</span> observed_max_sexM)</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>diff_ridge <span class="ot">&lt;-</span> <span class="fu">abs</span>(optimal_sexM_ridge <span class="sc">-</span> observed_max_sexM)</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Difference (Linear Regression):"</span>, diff_lasso, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Difference (Linear Regression): Inf </code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Difference (GPR):"</span>, diff_ridge, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Difference (GPR): 80.24661 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Difference (GPR):"</span>, diff_gpr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Difference (GPR): 1.05066 </code></pre>
</div>
</div>
<p>As you can see gpr model does much better job again.</p>
<p>We will do the same for all values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>lasso_coef <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">coef</span>(lassoModel, <span class="at">s =</span> <span class="st">"lambda.min"</span>))</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>ridge_coef <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">coef</span>(ridgeModel, <span class="at">s =</span> <span class="st">"lambda.min"</span>))</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>lm_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(lmModel)  <span class="co"># This is a named vector</span></span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to find optimal feature values</span></span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a>find_optimal_value <span class="ot">&lt;-</span> <span class="cf">function</span>(coefficients, feature_name, max_target) {</span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.matrix</span>(coefficients)) {</span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a>    intercept <span class="ot">&lt;-</span> coefficients[<span class="st">"(Intercept)"</span>, ]</span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a>    feature_coef <span class="ot">&lt;-</span> coefficients[feature_name, ]</span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true" tabindex="-1"></a>    intercept <span class="ot">&lt;-</span> coefficients[<span class="st">"(Intercept)"</span>]</span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true" tabindex="-1"></a>    feature_coef <span class="ot">&lt;-</span> coefficients[feature_name]</span>
<span id="cb219-14"><a href="#cb219-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb219-15"><a href="#cb219-15" aria-hidden="true" tabindex="-1"></a>  optimal_value <span class="ot">&lt;-</span> (max_target <span class="sc">-</span> intercept) <span class="sc">/</span> feature_coef</span>
<span id="cb219-16"><a href="#cb219-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(optimal_value)</span>
<span id="cb219-17"><a href="#cb219-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb219-18"><a href="#cb219-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-19"><a href="#cb219-19" aria-hidden="true" tabindex="-1"></a><span class="co"># List of features</span></span>
<span id="cb219-20"><a href="#cb219-20" aria-hidden="true" tabindex="-1"></a>features <span class="ot">&lt;-</span> <span class="fu">colnames</span>(X_selected)</span>
<span id="cb219-21"><a href="#cb219-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-22"><a href="#cb219-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Maximum target value</span></span>
<span id="cb219-23"><a href="#cb219-23" aria-hidden="true" tabindex="-1"></a>max_target <span class="ot">&lt;-</span> <span class="fu">max</span>(trainTarget)</span>
<span id="cb219-24"><a href="#cb219-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-25"><a href="#cb219-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize vectors to store optimal values</span></span>
<span id="cb219-26"><a href="#cb219-26" aria-hidden="true" tabindex="-1"></a>optimal_lasso <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(features))</span>
<span id="cb219-27"><a href="#cb219-27" aria-hidden="true" tabindex="-1"></a>optimal_ridge <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(features))</span>
<span id="cb219-28"><a href="#cb219-28" aria-hidden="true" tabindex="-1"></a>optimal_lm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(features))</span>
<span id="cb219-29"><a href="#cb219-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-30"><a href="#cb219-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each feature</span></span>
<span id="cb219-31"><a href="#cb219-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(features)) {</span>
<span id="cb219-32"><a href="#cb219-32" aria-hidden="true" tabindex="-1"></a>  feature <span class="ot">&lt;-</span> features[i]</span>
<span id="cb219-33"><a href="#cb219-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb219-34"><a href="#cb219-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate optimal value for Lasso</span></span>
<span id="cb219-35"><a href="#cb219-35" aria-hidden="true" tabindex="-1"></a>  optimal_lasso[i] <span class="ot">&lt;-</span> <span class="fu">find_optimal_value</span>(lasso_coef, feature, max_target)</span>
<span id="cb219-36"><a href="#cb219-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb219-37"><a href="#cb219-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate optimal value for Ridge</span></span>
<span id="cb219-38"><a href="#cb219-38" aria-hidden="true" tabindex="-1"></a>  optimal_ridge[i] <span class="ot">&lt;-</span> <span class="fu">find_optimal_value</span>(ridge_coef, feature, max_target)</span>
<span id="cb219-39"><a href="#cb219-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb219-40"><a href="#cb219-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate optimal value for Linear Regression</span></span>
<span id="cb219-41"><a href="#cb219-41" aria-hidden="true" tabindex="-1"></a>  optimal_lm[i] <span class="ot">&lt;-</span> <span class="fu">find_optimal_value</span>(lm_coef, feature, max_target)</span>
<span id="cb219-42"><a href="#cb219-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb219-43"><a href="#cb219-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-44"><a href="#cb219-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame to store the results</span></span>
<span id="cb219-45"><a href="#cb219-45" aria-hidden="true" tabindex="-1"></a>optimal_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb219-46"><a href="#cb219-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">Feature =</span> features,</span>
<span id="cb219-47"><a href="#cb219-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">Optimal_Lasso =</span> optimal_lasso,</span>
<span id="cb219-48"><a href="#cb219-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">Optimal_Ridge =</span> optimal_ridge,</span>
<span id="cb219-49"><a href="#cb219-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">Optimal_Linear =</span> optimal_lm</span>
<span id="cb219-50"><a href="#cb219-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb219-51"><a href="#cb219-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-52"><a href="#cb219-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb219-53"><a href="#cb219-53" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(optimal_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Feature Optimal_Lasso Optimal_Ridge Optimal_Linear
1         sexM           Inf     81.299930      96.716481
2          age   -127.654585    -42.320164     -44.881625
3     addressU           Inf    216.221243     630.697421
4         Medu           Inf     56.224337      53.987414
5         Fedu           Inf    -57.186216     -58.023390
6   Mjobhealth           Inf    149.953679     248.296727
7   traveltime           Inf     97.213956      66.207457
8     failures           Inf   -109.039321    -444.886442
9      paidyes           Inf     88.915585     151.707914
10   higheryes           Inf   -526.277539    -676.317209
11 romanticyes  -8899.628826    -59.810696     -76.549854
12       goout           Inf    178.482697     100.416811
13          G1     22.387603      9.030191      16.681422
14          G2      2.677584      3.361506       2.686848</code></pre>
</div>
</div>
<p>Now we will add columns of gpr optimal values. But first we need to combine all the variables we identified earlier for gpr into one.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine GPR optimal values into a vector</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>optimal_gpr <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sexM =</span> optimal_sexM_gpr,</span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> optimal_age_gpr,</span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">addressU =</span> optimal_addressU_gpr,</span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Medu =</span> optimal_Medu_gpr,</span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fedu =</span> optimal_Fedu_gpr,</span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mjobhealth =</span> optimal_Mjobhealth_gpr,</span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">traveltime =</span> optimal_traveltime_gpr,</span>
<span id="cb221-10"><a href="#cb221-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> optimal_failures_gpr,</span>
<span id="cb221-11"><a href="#cb221-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">paidyes =</span> optimal_paidyes_gpr,</span>
<span id="cb221-12"><a href="#cb221-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">higheryes =</span> optimal_higheryes_gpr,</span>
<span id="cb221-13"><a href="#cb221-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">romanticyes =</span> optimal_romanticyes_gpr,</span>
<span id="cb221-14"><a href="#cb221-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">goout =</span> optimal_goout_gpr,</span>
<span id="cb221-15"><a href="#cb221-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">G1 =</span> optimal_G1_gpr,</span>
<span id="cb221-16"><a href="#cb221-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">G2 =</span> optimal_G2_gpr</span>
<span id="cb221-17"><a href="#cb221-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb221-18"><a href="#cb221-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-19"><a href="#cb221-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined GPR optimal values</span></span>
<span id="cb221-20"><a href="#cb221-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(optimal_gpr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       sexM         age    addressU        Medu        Fedu  Mjobhealth 
 0.00265990  1.27505902 -0.72596413 -0.77678806 -0.57207202  1.38400075 
 traveltime    failures     paidyes   higheryes romanticyes       goout 
 1.39947599  1.46582906  0.03311317 -2.16202996  0.29762901 -0.18851610 
         G1          G2 
-0.09427021  1.79468671 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add GPR optimal values to the data frame</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>optimal_values<span class="sc">$</span>Optimal_GPR <span class="ot">&lt;-</span> optimal_gpr</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate maximum observed values for each feature</span></span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>max_observed_values <span class="ot">&lt;-</span> <span class="fu">apply</span>(X_selected, <span class="dv">2</span>, max)</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add maximum observed values to the data frame</span></span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>optimal_values<span class="sc">$</span>Max_Observed <span class="ot">&lt;-</span> max_observed_values</span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the absolute difference between each model's optimal value and the maximum observed value</span></span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a>optimal_values<span class="sc">$</span>Diff_Lasso <span class="ot">&lt;-</span> <span class="fu">abs</span>(optimal_values<span class="sc">$</span>Optimal_Lasso <span class="sc">-</span> optimal_values<span class="sc">$</span>Max_Observed)</span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true" tabindex="-1"></a>optimal_values<span class="sc">$</span>Diff_Ridge <span class="ot">&lt;-</span> <span class="fu">abs</span>(optimal_values<span class="sc">$</span>Optimal_Ridge <span class="sc">-</span> optimal_values<span class="sc">$</span>Max_Observed)</span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true" tabindex="-1"></a>optimal_values<span class="sc">$</span>Diff_Linear <span class="ot">&lt;-</span> <span class="fu">abs</span>(optimal_values<span class="sc">$</span>Optimal_Linear <span class="sc">-</span> optimal_values<span class="sc">$</span>Max_Observed)</span>
<span id="cb223-14"><a href="#cb223-14" aria-hidden="true" tabindex="-1"></a>optimal_values<span class="sc">$</span>Diff_GPR <span class="ot">&lt;-</span> <span class="fu">abs</span>(optimal_values<span class="sc">$</span>Optimal_GPR <span class="sc">-</span> optimal_values<span class="sc">$</span>Max_Observed)</span>
<span id="cb223-15"><a href="#cb223-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-16"><a href="#cb223-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine which model has the lowest difference for each feature</span></span>
<span id="cb223-17"><a href="#cb223-17" aria-hidden="true" tabindex="-1"></a>optimal_values<span class="sc">$</span>Best_Model <span class="ot">&lt;-</span> <span class="fu">colnames</span>(optimal_values[, <span class="fu">c</span>(<span class="st">"Diff_Lasso"</span>, <span class="st">"Diff_Ridge"</span>, <span class="st">"Diff_Linear"</span>, <span class="st">"Diff_GPR"</span>)])[</span>
<span id="cb223-18"><a href="#cb223-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(optimal_values[, <span class="fu">c</span>(<span class="st">"Diff_Lasso"</span>, <span class="st">"Diff_Ridge"</span>, <span class="st">"Diff_Linear"</span>, <span class="st">"Diff_GPR"</span>)], <span class="dv">1</span>, which.min)</span>
<span id="cb223-19"><a href="#cb223-19" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb223-20"><a href="#cb223-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-21"><a href="#cb223-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the updated data frame</span></span>
<span id="cb223-22"><a href="#cb223-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(optimal_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Feature Optimal_Lasso Optimal_Ridge Optimal_Linear Optimal_GPR
1         sexM           Inf     81.299930      96.716481  0.00265990
2          age   -127.654585    -42.320164     -44.881625  1.27505902
3     addressU           Inf    216.221243     630.697421 -0.72596413
4         Medu           Inf     56.224337      53.987414 -0.77678806
5         Fedu           Inf    -57.186216     -58.023390 -0.57207202
6   Mjobhealth           Inf    149.953679     248.296727  1.38400075
7   traveltime           Inf     97.213956      66.207457  1.39947599
8     failures           Inf   -109.039321    -444.886442  1.46582906
9      paidyes           Inf     88.915585     151.707914  0.03311317
10   higheryes           Inf   -526.277539    -676.317209 -2.16202996
11 romanticyes  -8899.628826    -59.810696     -76.549854  0.29762901
12       goout           Inf    178.482697     100.416811 -0.18851610
13          G1     22.387603      9.030191      16.681422 -0.09427021
14          G2      2.677584      3.361506       2.686848  1.79468671
   Max_Observed   Diff_Lasso Diff_Ridge Diff_Linear  Diff_GPR Best_Model
1     1.0533202          Inf  80.246610   95.663161 1.0506603   Diff_GPR
2     4.1564419  131.8110268  46.476606   49.038067 2.8813829   Diff_GPR
3     0.5347142          Inf 215.686529  630.162707 1.2606783   Diff_GPR
4     1.1424068          Inf  55.081930   52.845007 1.9191949   Diff_GPR
5     1.3586476          Inf  58.544863   59.382037 1.9307196   Diff_GPR
6     3.2543459          Inf 146.699334  245.042381 1.8703451   Diff_GPR
7     3.6586112          Inf  93.555344   62.548846 2.2591352   Diff_GPR
8     3.5847768          Inf 112.624098  448.471219 2.1189478   Diff_GPR
9     1.0859683          Inf  87.829616  150.621946 1.0528552   Diff_GPR
10    0.2306476          Inf 526.508187  676.547856 2.3926776   Diff_GPR
11    1.4097447 8901.0385702  61.220441   77.959599 1.1121157   Diff_GPR
12    1.6987122          Inf 176.783985   98.718099 1.8872283   Diff_GPR
13    2.4376814   19.9499218   6.592509   14.243740 2.5319516   Diff_GPR
14    2.2028621    0.4747219   1.158644    0.483986 0.4081754   Diff_GPR</code></pre>
</div>
</div>
<p>As we can see, across all features, the gpr model was best. Here is a visual for it. We will get rid of the lasso difference because it seems to be predicting for infinite for most features.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load ggplot2 for visualization</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'tidyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:Matrix':

    expand, pack, unpack</code></pre>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the data frame to long format for plotting</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>optimal_values_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(optimal_values, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"Diff"</span>), <span class="at">names_to =</span> <span class="st">"Model"</span>, <span class="at">values_to =</span> <span class="st">"Difference"</span>)</span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the differences</span></span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(optimal_values_long, <span class="fu">aes</span>(<span class="at">x =</span> Feature, <span class="at">y =</span> Difference, <span class="at">fill =</span> Model)) <span class="sc">+</span></span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Difference Between Optimal Values and Maximum Observed Values"</span>,</span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Feature"</span>, <span class="at">y =</span> <span class="st">"Difference"</span>) <span class="sc">+</span></span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here is the same graph but excluding lasso difference, because it seems to be prediciting infinity for most values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load ggplot2 for visualization</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the data frame to long format for plotting</span></span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>optimal_values_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(optimal_values, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"Diff_Ridge"</span>, <span class="st">"Diff_Linear"</span>, <span class="st">"Diff_GPR"</span>), <span class="at">names_to =</span> <span class="st">"Model"</span>, <span class="at">values_to =</span> <span class="st">"Difference"</span>)</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the differences</span></span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(optimal_values_long, <span class="fu">aes</span>(<span class="at">x =</span> Feature, <span class="at">y =</span> Difference, <span class="at">fill =</span> Model)) <span class="sc">+</span></span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Difference Between Optimal Values and Maximum Observed Values (Excluding Lasso)"</span>,</span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Feature"</span>, <span class="at">y =</span> <span class="st">"Difference"</span>) <span class="sc">+</span></span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb229-14"><a href="#cb229-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="at-risk-students" class="level1">
<h1>At-Risk students</h1>
<p>This is another concept that GPR excxels at compared to other models because it uses uncertainity. Now letâ€™s assume a student who is predicted less than grade 10 is at risk.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GauPro)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'GauPro' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: mixopt</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'mixopt' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: splitfngr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'splitfngr' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: numDeriv</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: rmarkdown</code></pre>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Train GPR model with GauPro</span></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>gprModel_gaupro <span class="ot">&lt;-</span> <span class="fu">GauPro</span>(X_selected[trainIndex, ], trainTarget)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `GauPro_Gauss$new()` was deprecated in GauPro 0.2.12.
â„¹ Please use GauPro::GauPro_kernel_model instead
â„¹ The deprecated feature was likely used in the R6 package.
  Please report the issue at &lt;https://github.com/r-lib/R6/issues&gt;.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Error in eval(expr, envir, enclos) : solve(): solution not found
Error in eval(expr, envir, enclos) : chol(): decomposition failed
Error in eval(expr, envir, enclos) : chol(): decomposition failed</code></pre>
</div>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict with GPR and uncertainty</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>gprPredictions_gaupro <span class="ot">&lt;-</span> <span class="fu">predict</span>(gprModel_gaupro, X_selected, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract mean predictions and standard deviations</span></span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>mean_predictions <span class="ot">&lt;-</span> gprPredictions_gaupro<span class="sc">$</span>mean</span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a>std_predictions <span class="ot">&lt;-</span> gprPredictions_gaupro<span class="sc">$</span>se</span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-8"><a href="#cb241-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify at-risk students (e.g., predicted grade &lt; threshold with high uncertainty)</span></span>
<span id="cb241-9"><a href="#cb241-9" aria-hidden="true" tabindex="-1"></a>at_risk_students_gpr <span class="ot">&lt;-</span> <span class="fu">which</span>(mean_predictions <span class="sc">&lt;</span> threshold <span class="sc">&amp;</span> std_predictions <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb241-10"><a href="#cb241-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"At-Risk Students (GPR):"</span>, at_risk_students_gpr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>At-Risk Students (GPR): 1 2 11 41 68 69 82 112 119 128 132 147 151 161 171 190 206 207 211 217 221 251 268 270 281 318 354 355 359 366 378 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify at-risk students for lm</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>at_risk_students_lm <span class="ot">&lt;-</span> <span class="fu">which</span>(lmPredictions <span class="sc">&lt;</span> threshold)</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"At-Risk Students (Linear Regression):"</span>, at_risk_students_lm, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>At-Risk Students (Linear Regression): 1 2 5 10 13 15 16 18 19 23 25 27 28 29 30 31 33 34 37 39 40 41 43 46 47 48 50 52 53 54 62 63 64 67 69 71 74 76 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify at-risk students for lasso</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>at_risk_students_lasso <span class="ot">&lt;-</span> <span class="fu">which</span>(lassoPredictions <span class="sc">&lt;</span> threshold)</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"At-Risk Students (Lasso):"</span>, at_risk_students_lasso, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>At-Risk Students (Lasso): 1 2 5 10 13 15 16 18 19 23 25 27 28 29 30 31 33 34 37 39 40 41 43 46 47 48 50 52 53 54 62 63 64 67 69 71 74 76 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify at-risk students for ridge</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>at_risk_students_ridge <span class="ot">&lt;-</span> <span class="fu">which</span>(ridgePredictions <span class="sc">&lt;</span> threshold)</span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"At-Risk Students (Ridge):"</span>, at_risk_students_ridge, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>At-Risk Students (Ridge): 1 2 5 10 13 15 16 19 23 25 27 28 29 30 31 33 34 37 39 40 41 43 46 47 48 50 53 54 62 63 64 67 69 71 74 76 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame to compare results</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>at_risk_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"GPR"</span>, <span class="st">"Linear Regression"</span>, <span class="st">"Lasso"</span>, <span class="st">"Ridge"</span>),</span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">At_Risk_Count =</span> <span class="fu">c</span>(</span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">length</span>(at_risk_students_gpr),</span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">length</span>(at_risk_students_lm),</span>
<span id="cb249-7"><a href="#cb249-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">length</span>(at_risk_students_lasso),</span>
<span id="cb249-8"><a href="#cb249-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">length</span>(at_risk_students_ridge)</span>
<span id="cb249-9"><a href="#cb249-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb249-10"><a href="#cb249-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb249-11"><a href="#cb249-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-12"><a href="#cb249-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the comparison</span></span>
<span id="cb249-13"><a href="#cb249-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(at_risk_comparison)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Model At_Risk_Count
1               GPR            31
2 Linear Regression            38
3             Lasso            38
4             Ridge            36</code></pre>
</div>
</div>
<p>This implies that GPR model identified less students but with higher confidence that they are at risk, whereas the other models donâ€™t have any confidence.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load ggplot2 for visualization</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the comparison</span></span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(at_risk_comparison, <span class="fu">aes</span>(<span class="at">x =</span> Model, <span class="at">y =</span> At_Risk_Count, <span class="at">fill =</span> Model)) <span class="sc">+</span></span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of At-Risk Students Identified by Each Model"</span>,</span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Model"</span>, <span class="at">y =</span> <span class="st">"Number of At-Risk Students"</span>) <span class="sc">+</span></span>
<span id="cb251-9"><a href="#cb251-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="M-O-assignment-task-1_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>